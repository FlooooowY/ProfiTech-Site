# Техническая спецификация сайта ProfiTech

## 1. Общая информация

**Название проекта:** ProfiTech - Каталог профессионального оборудования  
**Версия:** 1.0.0  
**Дата составления:** 2025  
**Тип проекта:** Интернет-магазин / Каталог товаров B2B  

## 2. Назначение и цели проекта

Сайт предназначен для:
- Представления каталога профессионального оборудования
- Поиска и фильтрации товаров по различным параметрам
- Формирования заявок на покупку через интеграцию с WhatsApp
- Управления контентом через административную панель
- Поддержки многоязычности (русский и английский языки)

## 3. Технологический стек

### 3.1. Frontend
- **Framework:** Next.js 16.1.0 (App Router)
- **Язык программирования:** TypeScript 5
- **UI библиотека:** React 19.2.3
- **Стилизация:** Tailwind CSS 4
- **Анимации:** Framer Motion 12.23.26
- **Иконки:** Lucide React 0.562.0, React Icons 5.5.0
- **Интернационализация:** next-intl 4.6.1

### 3.2. Backend
- **Runtime:** Node.js 20.x
- **Framework:** Next.js API Routes
- **База данных:** MongoDB 6.x
- **ORM/Driver:** MongoDB Native Driver 6.10.0

### 3.3. State Management
- **Глобальное состояние:** Zustand 5.0.9
- **Серверное состояние:** TanStack React Query 5.90.12

### 3.4. Инфраструктура
- **Веб-сервер:** Nginx 1.18+
- **Process Manager:** PM2
- **SSL/TLS:** Let's Encrypt
- **Домен:** profitech.store

### 3.5. Инструменты разработки
- **Сборщик:** Next.js (Turbopack)
- **Линтер:** ESLint 9
- **Парсеры:** PapaParse 5.5.3 (CSV), csv-parse 6.1.0

## 4. Функциональные требования

### 4.1. Публичная часть сайта

#### 4.1.1. Главная страница
- Карусель с промо-материалами
- Блок преимуществ компании
- Категории товаров с визуальными карточками
- Призыв к действию (CTA)

#### 4.1.2. Каталог товаров
- Отображение товаров с пагинацией
- Фильтрация по:
  - Категориям и подкатегориям
  - Производителям
  - Характеристикам товаров
- Поиск по названию товара
- Сортировка товаров
- Быстрый просмотр товара (модальное окно)
- Адаптивная верстка для мобильных устройств

#### 4.1.3. Страница товара
- Детальная информация о товаре
- Галерея изображений
- Характеристики товара
- Кнопки действий (добавить в корзину, избранное, запросить цену)

#### 4.1.4. Корзина / Список запросов
- Отображение выбранных товаров
- Редактирование количества
- Формирование заявки для отправки в WhatsApp
- Очистка корзины

#### 4.1.5. Избранное
- Сохранение товаров в избранное
- Управление списком избранного
- Переход к товару из избранного

#### 4.1.6. Контакты
- Контактная информация компании
- Форма обратной связи
- Интеграция с WhatsApp

#### 4.1.7. О компании
- Информация о компании

### 4.2. Административная панель

#### 4.2.1. Аутентификация
- Вход по логину и паролю
- JWT токены для сессий
- HTTP-only cookies для безопасности

#### 4.2.2. Управление каталогом
- Импорт товаров из CSV файлов
- Статистика по товарам и категориям
- Просмотр текущего состояния базы данных

### 4.3. Интернационализация
- Поддержка русского и английского языков
- Переключение языка через UI
- Переводы интерфейса
- Переводы названий товаров и характеристик
- Переводы категорий и подкатегорий

## 5. Структура данных

### 5.1. База данных MongoDB

#### 5.1.1. Коллекция `products`
```typescript
{
  _id: ObjectId,
  id: string,                    // Уникальный идентификатор
  name: string,                  // Название товара (RU)
  name_en?: string,              // Название товара (EN)
  description: string,           // Описание (RU)
  description_en?: string,       // Описание (EN)
  categoryId: string,            // ID категории
  subcategoryId: string,        // ID подкатегории (формат: categorySlug-subcategorySlug)
  manufacturer: string,           // Производитель
  characteristics: [             // Характеристики товара
    {
      name: string,              // Название характеристики (RU)
      name_en?: string,          // Название характеристики (EN)
      value: string,             // Значение (RU)
      value_en?: string          // Значение (EN)
    }
  ],
  images: string[],              // Массив URL изображений
  createdAt: Date,
  updatedAt: Date
}
```

#### 5.1.2. Коллекция `categories`
```typescript
{
  _id: ObjectId,
  id: string,                    // Уникальный идентификатор
  name: string,                  // Название категории
  slug: string,                  // URL-friendly идентификатор
  description?: string,           // Описание
  icon?: string                  // Иконка
}
```

#### 5.1.3. Коллекция `subcategories`
```typescript
{
  _id: ObjectId,
  id: string,                    // Уникальный идентификатор
  name: string,                  // Название подкатегории
  slug: string,                  // URL-friendly идентификатор
  categoryId: string,           // ID родительской категории
  description?: string           // Описание
}
```

### 5.2. Индексы базы данных
- Индекс на `products.categoryId`
- Индекс на `products.subcategoryId`
- Индекс на `products.manufacturer`
- Текстовый индекс для поиска по названию товара

## 6. API Endpoints

### 6.1. Публичные API

#### GET `/api/catalog`
Получение списка товаров с фильтрацией и пагинацией

**Параметры запроса:**
- `page` (number) - номер страницы
- `limit` (number) - количество товаров на странице
- `categoryId` (string) - фильтр по категории
- `subcategories` (string[]) - фильтр по подкатегориям
- `manufacturers` (string[]) - фильтр по производителям
- `characteristics` (object) - фильтр по характеристикам
- `search` (string) - поисковый запрос

**Ответ:**
```json
{
  "products": Product[],
  "pagination": {
    "currentPage": number,
    "totalPages": number,
    "totalItems": number,
    "itemsPerPage": number
  }
}
```

#### GET `/api/catalog/stats`
Получение статистики для фильтров

**Ответ:**
```json
{
  "manufacturers": string[],
  "characteristics": {
    [key: string]: string[]
  },
  "categories": Category[]
}
```

### 6.2. Административные API

#### POST `/api/admin/login`
Аутентификация администратора

**Тело запроса:**
```json
{
  "username": string,
  "password": string
}
```

**Ответ:**
```json
{
  "success": boolean,
  "token": string
}
```

#### GET `/api/admin/auth`
Проверка статуса аутентификации

#### POST `/api/import`
Импорт товаров из CSV

## 7. Производительность и оптимизация

### 7.1. Кэширование
- In-memory кэш для частых запросов (TTL: 5 минут)
- Кэширование статистики фильтров
- Кэширование статических файлов через Nginx

### 7.2. Оптимизация запросов
- Пагинация товаров (стандартная OFFSET)
- Условные COUNT запросы (только для первых 10 страниц)
- Индексы MongoDB для быстрого поиска
- Параллельное выполнение независимых запросов

### 7.3. Оптимизация фронтенда
- Server-Side Rendering (SSR) для SEO
- Code splitting и lazy loading
- Оптимизация изображений через Next.js Image
- Минификация и сжатие ресурсов

## 8. Безопасность

### 8.1. Аутентификация и авторизация
- JWT токены для сессий администратора
- HTTP-only cookies для хранения токенов
- Хеширование паролей (bcrypt)
- Защита API маршрутов администратора

### 8.2. Защита данных
- Валидация входных данных
- Защита от SQL/NoSQL инъекций
- Ограничение размера загружаемых файлов (50MB)
- HTTPS для всех соединений

### 8.3. Инфраструктура
- Firewall (UFW) с открытыми портами 80, 443, 22
- SSL/TLS сертификаты (Let's Encrypt)
- Регулярное обновление зависимостей

## 9. Адаптивность и совместимость

### 9.1. Адаптивный дизайн
- Mobile-first подход
- Breakpoints: mobile (< 768px), tablet (768px - 1024px), desktop (> 1024px)
- Оптимизация для touch-устройств

### 9.2. Браузерная совместимость
- Chrome (последние 2 версии)
- Firefox (последние 2 версии)
- Safari (последние 2 версии)
- Edge (последние 2 версии)

## 10. Развертывание и инфраструктура

### 10.1. Серверные требования
- **ОС:** Ubuntu 22.04 LTS или выше
- **Node.js:** 20.x
- **MongoDB:** 6.x
- **Nginx:** 1.18+
- **PM2:** для управления процессами

### 10.2. Процесс развертывания
1. Клонирование репозитория
2. Установка зависимостей (`npm install`)
3. Настройка переменных окружения (`.env.local`)
4. Сборка проекта (`npm run build`)
5. Запуск через PM2 (`pm2 start`)
6. Настройка Nginx как reverse proxy
7. Настройка SSL сертификата

### 10.3. Мониторинг
- PM2 для мониторинга процессов
- Логирование через PM2 logs
- Мониторинг доступности через скрипты проверки

## 11. Категории и структура каталога

### 11.1. Категории товаров
1. **Профоборудование** (15 подкатегорий)
2. **Кофеварки и кофемашины** (13 подкатегорий)
3. **Промышленная мебель** (4 подкатегории)
4. **Климатическая техника** (3 подкатегории)
5. **Телекоммуникационное оборудование** (2 подкатегории)
6. **Точки продаж** (1 подкатегория)
7. **Бытовая техника** (1 подкатегория)

**Всего:** 7 категорий, 39 подкатегорий

## 12. Интеграции

### 12.1. WhatsApp
- Интеграция для отправки заявок на покупку
- Формирование сообщений с деталями заказа
- Настраиваемый номер WhatsApp

### 12.2. Системы перевода (опционально)
- Google Translate API (для автоматического перевода)
- LibreTranslate (локальный сервер для перевода)

## 13. Поддержка и обслуживание

### 13.1. Обновления
- Автоматическое обновление через Git
- Скрипты для обновления сервера
- Резервное копирование базы данных

### 13.2. Мониторинг
- Проверка работоспособности сервисов
- Мониторинг доступности сайта
- Проверка DNS записей

## 14. Технические ограничения

- Максимальный размер загружаемого CSV файла: 50MB
- Максимальное количество товаров на странице: 50
- Таймаут запросов к базе данных: 45 секунд
- Время жизни кэша: 5 минут

## 15. Дополнительные возможности

- AI-помощник (готов к интеграции с OpenAI)
- Система уведомлений
- Аналитика посещений (готово к интеграции)
- Экспорт данных (готово к реализации)

---

**Версия документа:** 1.0  
**Дата последнего обновления:** 2025  
**Статус:** Актуальная версия

